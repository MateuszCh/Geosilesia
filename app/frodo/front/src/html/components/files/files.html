<p class="m-t" ng-if="vm.loadingstatus">Loading...</p>
<div class="add-file__inner"
     ng-if="!vm.loadingstatus"
     ng-class="{'section' : vm.section}">
    <div class="add-file__inner__panel">
        <button class="button" ng-click="vm.chooseView('choose')" ng-class="{'button--active' : vm.activeView == 'choose'}">Wybierz plik</button>
        <button class="button" ng-click="vm.chooseView('add')" ng-class="{'button--active' : vm.activeView == 'add'}">Dodaj nowe pliki</button>
    </div>
    <div ng-show="vm.activeView == 'add'"
         class="add-file__inner__add">
        <div class="new-files">
            <div class="new-files__form">
                <button class="button" ngf-select ng-model="vm.files" name="files" ngf-change="vm.onFilesSelect()" ngf-multiple="true" ngf-pattern="'image/*,application/pdf'"
                        ngf-accept="'image/*,application/pdf'">Wybierz pliki</button>
                <button class="button block m-t" ng-click="vm.upload()" ng-class="{'busy' : vm.actionStatus.busyType === 'upload'}">Zapisz</button>
                <p ng-bind="vm.actionStatus.result" ng-if="vm.actionStatus.result"></p>
            </div>
        </div>
        <div class="edit-new-files"
             ng-if="vm.files.length">
            <div class="edit-new-files__list">
                <div ng-repeat="file in vm.files" class="edit-new-files__list__item" ng-click="vm.editIndex($index)">
                    <span class="edit-new-files__list__item__title" ng-bind="file.name"></span>
                </div>
            </div>
            <div class="edit-new-files__editor" ng-if="vm.files.length">
                <div class="edit-new-files__editor__preview">
                    <h2 class="font-2 custom-post-types__subheading" ng-bind="vm.files[vm.currentIndex].name"></h2>
                    <div class="edit-new-files__editor__preview__image" ng-switch="vm.files[vm.currentIndex].type != 'application/pdf'">
                        <img ngf-src="vm.files[vm.currentIndex]" ng-switch-when="true">
                        <img ng-switch-when="false" src="images/pdf-placeholder.png">
                    </div>
                    <button class="button" ng-click="vm.removeFile()">Usuń</button>
                </div>
                <div class="edit-new-files__editor__form">
                    <form name="editFiles" novalidate>
                        <div class="input input--inline">
                            <label for="title">Tytuł:</label>
                            <input id="title"
                                   type="text"
                                   ng-model="vm.data[vm.currentIndex].title">
                            <span class="input__notice"></span>
                        </div>
                        <div class="input input--inline">
                            <label for="description">Opis:</label>
                            <input id="description"
                                   type="text"
                                   ng-model="vm.data[vm.currentIndex].description">
                            <span class="input__notice"></span>
                        </div>
                        <div class="input input--inline">
                            <label for="author">Autor:</label>
                            <input id="author"
                                   type="text"
                                   ng-model="vm.data[vm.currentIndex].author">
                            <span class="input__notice"></span>
                        </div>
                        <div class="input input--inline">
                            <label for="date">Data:</label>
                            <input id="date"
                                   type="date"
                                   ng-model="vm.data[vm.currentIndex].date">
                            <span class="input__notice"></span>
                        </div>
                        <div class="input input--inline">
                            <label for="place">Miejsce:</label>
                            <input id="place"
                                   type="text"
                                   ng-model="vm.data[vm.currentIndex].place">
                            <span class="input__notice"></span>
                        </div>
                        <div class="input input--inline">
                            <label for="catalogue">Katalog:</label>
                            <input id="catalogue"
                                   type="text"
                                   ng-model="vm.data[vm.currentIndex].catalogue">
                            <span class="input__notice"></span>
                        </div>
                        <div class="input input--inline" ng-if="vm.catalogues.length">
                            <label for="selectCatalogue">Wybierz z istniejących</label>
                            <select id="selectCatalogue" ng-model="vm.data[vm.currentIndex].catalogue" ng-options="catalogue for catalogue in vm.catalogues"></select>
                        </div>
                    </form>
                </div>
            </div>
        </div>


    </div>
    <div ng-show="vm.activeView == 'choose'"
         class="add-file__inner__choose">
        <p ng-if="!vm.allFiles.length">Obecnie nie ma żadnych plików</p>
        <div class="choose-list"
             ng-if="vm.allFiles.length">
            <div ng-repeat="file in vm.allFiles" class="ratio-1-1 choose-list__item m-b m-r" ng-click="vm.existingFilesIndex($index)" ng-switch="::file.type != 'application/pdf'">
                <img src="{{::file.src}}" class="fill" ng-switch-when="true">
                <img ng-switch-when="false" class="fill" src="images/pdf-placeholder.png">
            </div>
        </div>
        <div class="choose-edit"
             ng-if="vm.allFiles.length">
            <div class="choose-edit__info m-b">
                <h3 class="choose-edit__info__filename m-b" ng-bind="vm.allFiles[vm.currentExistingIndex].filename"></h3>
                <div class="choose-edit__info__image m-b" ng-switch="vm.allFiles[vm.currentExistingIndex].type !== 'application/pdf'">
                    <img src="{{vm.allFiles[vm.currentExistingIndex].src}}" ng-switch-when="true">
                    <img ng-switch-when="false" src="images/pdf-placeholder.png">
                </div>
                <p class="choose-edit__info__label">Data utworzenia:</p>
                <p class="choose-edit__info__field" ng-bind="vm.allFiles[vm.currentExistingIndex].created | date: 'medium'"></p>
                <p class="choose-edit__info__label">Url:</p>
                <a class="choose-edit__info__field" target="_blank" ng-href="{{vm.allFiles[vm.currentExistingIndex].src}}" ng-bind="vm.allFiles[vm.currentExistingIndex].src"></a>
                <p class="choose-edit__info__label">Typ pliku:</p>
                <p class="choose-edit__info__field" ng-bind="vm.allFiles[vm.currentExistingIndex].type"></p>
            </div>
            <div class="choose-edit__form">
                <form name="editSavedFiles" novalidate>
                    <div class="input input--inline">
                        <label for="editTitle">Tytuł:</label>
                        <input id="editTitle"
                               type="text"
                               ng-model="vm.allFiles[vm.currentExistingIndex].title">
                        <span class="input__notice"></span>
                    </div>
                    <div class="input input--inline">
                        <label for="editDescription">Opis:</label>
                        <input id="editDescription"
                               type="text"
                               ng-model="vm.allFiles[vm.currentExistingIndex].description">
                        <span class="input__notice"></span>
                    </div>
                    <div class="input input--inline">
                        <label for="editAuthor">Autor:</label>
                        <input id="editAuthor"
                               type="text"
                               ng-model="vm.allFiles[vm.currentExistingIndex].author">
                        <span class="input__notice"></span>
                    </div>
                    <div class="input input--inline">
                        <label for="editDate">Data:</label>
                        <input id="editDate"
                               type="date"
                               ng-model="vm.allFiles[vm.currentExistingIndex].date">
                        <span class="input__notice"></span>
                    </div>
                    <div class="input input--inline">
                        <label for="editPlace">Miejsce:</label>
                        <input id="editPlace"
                               type="text"
                               ng-model="vm.allFiles[vm.currentExistingIndex].place">
                        <span class="input__notice"></span>
                    </div>
                    <div class="input input--inline">
                        <label for="editCatalogue">Katalog:</label>
                        <input id="editCatalogue"
                               type="text"
                               ng-model="vm.allFiles[vm.currentExistingIndex].catalogue">
                        <span class="input__notice"></span>
                    </div>
                    <div class="input input--inline" ng-if="vm.catalogues.length">
                        <label for="editSelectCatalogue">Wybierz z istniejących</label>
                        <select id="editSelectCatalogue"
                                ng-model="vm.allFiles[vm.currentExistingIndex].catalogue"
                                ng-options="catalogue for catalogue in vm.catalogues"></select>
                    </div>
                </form>
            </div>
            <div>
                <button class="button" ng-click="vm.deleteFile()" ng-class="{'busy' : vm.actionStatus.busyType === 'delete'}">Usuń plik</button>
                <button class="button" ng-click="vm.saveFile()" ng-class="{'busy' : vm.actionStatus.busyType === 'save'}">Zapisz zmiany</button>
                <button class="button" ng-click="vm.chooseFile()">Wybierz plik</button>
                <p ng-if="vm.actionStatus.result"
                   ng-bind="vm.actionStatus.result"></p>

            </div>
        </div>
    </div>
</div>